###### Не следует использовать слабые протоколы SSL/TLS.

Уязвимость
Критический

     Доступно с 19 декабря 2023 г.
     СонарКьюб (Java)
     Постоянно/проблема: 2 мин.

Это правило создает проблему, когда используется или разрешена небезопасная версия протокола TLS (т. е. протокол, отличный от «TLSv1.2», «TLSv1.3», «DTLSv1.2» или «DTLSv1.3»).

Рекомендуется установить TLS 1.2 в качестве минимальной версии протокола и запретить более старые версии, такие как TLS 1.0. Невыполнение этого требования может открыть возможности для атак на понижение версии: злоумышленник, способный перехватить соединение, может изменить запрошенную версию протокола и понизить ее до менее безопасной версии.

В большинстве случаев использование конфигурации системы по умолчанию не соответствует требованиям. Действительно, приложение может быть развернуто в широком спектре систем с разными конфигурациями. Хотя использование системного значения по умолчанию может быть безопасным в современных современных системах, в старых системах это может быть не так. Поэтому рекомендуется в каждом случае явно устанавливать безопасную конфигурацию.
Пример несовместимого кода

javax.net.ssl.SSLContext library:

context = SSLContext.getInstance("TLSv1.1"); // Noncompliant

okhttp library:

ConnectionSpec spec = new ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS)
      .tlsVersions(TlsVersion.TLS_1_1) // Noncompliant
      .build();

Compliant Solution

javax.net.ssl.SSLContext library:

context = SSLContext.getInstance("TLSv1.2"); // Compliant

okhttp library:

ConnectionSpec spec = new ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS)
      .tlsVersions(TlsVersion.TLS_1_2) // Compliant
      .build();

See

    OWASP Top 10 2021 Category A2 - Cryptographic Failures
    OWASP Top 10 2021 Category A7 - Identification and Authentication Failures
    OWASP Top 10 2017 Category A3 - Sensitive Data Exposure
    OWASP Top 10 2017 Category A6 - Security Misconfiguration
    MITRE, CWE-327 - Inadequate Encryption Strength
    MITRE, CWE-326 - Use of a Broken or Risky Cryptographic Algorithm
    SANS Top 25 - Porous Defenses
    Diagnosing TLS, SSL, and HTTPS
    SSL and TLS Deployment Best Practices - Use secure protocols
